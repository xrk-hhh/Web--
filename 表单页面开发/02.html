<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>带文件上传的表单提交演示</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        neutral: '#64748B',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .form-input-focus {
                @apply focus:ring-2 focus:ring-primary/50 focus:border-primary focus:outline-none;
            }
            .transition-custom {
                @apply transition-all duration-300 ease-in-out;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans text-gray-800">
    <div class="container mx-auto px-4 py-8 max-w-3xl">
        <!-- 页面标题 -->
        <header class="text-center mb-10">
            <h1 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-gray-800 mb-2">
                <i class="fa fa-file-text-o text-primary mr-2"></i>表单提交演示
            </h1>
            <p class="text-neutral">填写表单、上传文件并提交，查看结果展示</p>
        </header>

        <!-- 表单页面 -->
        <section id="form-section" class="bg-white rounded-xl shadow-lg p-6 md:p-8 transition-custom">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800">请填写以下信息</h2>
            
            <form id="user-form" class="space-y-5">
                <!-- 姓名输入 -->
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">姓名</label>
                    <input 
                        type="text" 
                        id="name" 
                        name="name" 
                        required
                        autocomplete="name"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg form-input-focus"
                        placeholder="请输入您的姓名"
                    >
                </div>
                
                <!-- 邮箱输入 -->
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">邮箱</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        required
                        autocomplete="email"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg form-input-focus"
                        placeholder="请输入您的邮箱"
                    >
                </div>
                
                <!-- 留言输入 -->
                <div>
                    <label for="message" class="block text-sm font-medium text-gray-700 mb-1">留言</label>
                    <textarea 
                        id="message" 
                        name="message" 
                        rows="4"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg form-input-focus"
                        placeholder="请输入您的留言（可选）"
                    ></textarea>
                </div>
                
                <!-- 兴趣爱好选择 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-3">兴趣爱好（可多选）</label>
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <input 
                                type="checkbox" 
                                id="hobby-reading" 
                                name="hobbies" 
                                value="阅读"
                                class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
                            >
                            <label for="hobby-reading" class="ml-2 text-gray-700">阅读</label>
                        </div>
                        <div class="flex items-center">
                            <input 
                                type="checkbox" 
                                id="hobby-sports" 
                                name="hobbies" 
                                value="运动"
                                class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
                            >
                            <label for="hobby-sports" class="ml-2 text-gray-700">运动</label>
                        </div>
                        <div class="flex items-center">
                            <input 
                                type="checkbox" 
                                id="hobby-music" 
                                name="hobbies" 
                                value="音乐"
                                class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
                            >
                            <label for="hobby-music" class="ml-2 text-gray-700">音乐</label>
                        </div>
                        <div class="flex items-center">
                            <input 
                                type="checkbox" 
                                id="hobby-travel" 
                                name="hobbies" 
                                value="旅行"
                                class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
                            >
                            <label for="hobby-travel" class="ml-2 text-gray-700">旅行</label>
                        </div>
                    </div>
                </div>
                
                <!-- 文件上传区域 -->
                <div>
                    <label for="file-upload" class="block text-sm font-medium text-gray-700 mb-3">上传文件（可选）</label>
                    
                    <!-- 上传区域 -->
                    <div id="upload-container" class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-primary transition-custom cursor-pointer">
                        <input 
                            type="file" 
                            id="file-upload" 
                            name="file-upload" 
                            accept="image/*,.pdf,.doc,.docx,.txt"
                            class="hidden"
                        >
                        
                        <div id="upload-icon" class="mb-3">
                            <i class="fa fa-cloud-upload text-4xl text-neutral"></i>
                        </div>
                        
                        <div id="upload-text">
                            <p class="text-gray-700 font-medium mb-1">点击或拖拽文件到此处上传</p>
                            <p class="text-sm text-neutral">支持 JPG, PNG, PDF, DOC 等格式，最大 10MB</p>
                        </div>
                        
                        <!-- 文件预览区域 -->
                        <div id="file-preview" class="mt-4 hidden">
                            <div class="bg-gray-50 p-3 rounded-lg flex items-center">
                                <i id="file-icon" class="fa fa-file text-primary mr-3"></i>
                                <div class="flex-1 text-left">
                                    <p id="file-name" class="font-medium truncate"></p>
                                    <p id="file-size" class="text-sm text-neutral"></p>
                                </div>
                                <button type="button" id="remove-file" class="text-neutral hover:text-red-500 transition-custom">
                                    <i class="fa fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 提交和重置按钮 -->
                <div class="pt-2 flex space-x-4">
                    <!-- 重置按钮 -->
                    <button 
                        type="reset" 
                        class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 px-4 rounded-lg transition-custom flex items-center justify-center"
                    >
                        <i class="fa fa-refresh mr-2"></i>重置表单
                    </button>
                    
                    <!-- 提交按钮 -->
                    <button 
                        type="submit" 
                        class="flex-1 bg-primary hover:bg-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-custom flex items-center justify-center"
                    >
                        <i class="fa fa-paper-plane mr-2"></i>提交表单
                    </button>
                </div>
            </form>
        </section>

        <!-- 完成页面 -->
        <section id="result-section" class="hidden bg-white rounded-xl shadow-lg p-6 md:p-8 transition-custom">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 text-secondary mb-4">
                    <i class="fa fa-check text-2xl"></i>
                </div>
                <h2 class="text-2xl font-semibold text-gray-800">提交成功！</h2>
                <p class="text-neutral mt-1">以下是您提交的信息</p>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-6 space-y-4">
                <div class="flex flex-col md:flex-row md:items-center">
                    <span class="text-neutral w-full md:w-24">姓名：</span>
                    <span id="result-name" class="font-medium"></span>
                </div>
                <div class="flex flex-col md:flex-row md:items-center">
                    <span class="text-neutral w-full md:w-24">邮箱：</span>
                    <span id="result-email" class="font-medium"></span>
                </div>
                <div class="flex flex-col md:flex-row md:items-start">
                    <span class="text-neutral w-full md:w-24 pt-1">留言：</span>
                    <span id="result-message" class="font-medium">无留言</span>
                </div>
                <div class="flex flex-col md:flex-row md:items-center">
                    <span class="text-neutral w-full md:w-24">兴趣爱好：</span>
                    <span id="result-hobbies" class="font-medium"></span>
                </div>
                <div class="flex flex-col md:flex-row md:items-start">
                    <span class="text-neutral w-full md:w-24 pt-1">上传文件：</span>
                    <div id="result-file" class="font-medium">
                        <p>未上传文件</p>
                    </div>
                </div>
            </div>
            
            <!-- 返回按钮 -->
            <div class="mt-8">
                <button 
                    id="back-btn" 
                    class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 px-4 rounded-lg transition-custom flex items-center justify-center"
                >
                    <i class="fa fa-arrow-left mr-2"></i>返回修改
                </button>
            </div>
        </section>
    </div>

    <script>
        // 获取DOM元素
        const formSection = document.getElementById('form-section');
        const resultSection = document.getElementById('result-section');
        const userForm = document.getElementById('user-form');
        const backBtn = document.getElementById('back-btn');
        const uploadContainer = document.getElementById('upload-container');
        const fileInput = document.getElementById('file-upload');
        const filePreview = document.getElementById('file-preview');
        const fileName = document.getElementById('file-name');
        const fileSize = document.getElementById('file-size');
        const fileIcon = document.getElementById('file-icon');
        const removeFileBtn = document.getElementById('remove-file');
        const uploadIcon = document.getElementById('upload-icon');
        const uploadText = document.getElementById('upload-text');
        
        // 文件上传相关事件
        uploadContainer.addEventListener('click', () => {
            fileInput.click();
        });
        
        // 处理文件选择
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                displayFileInfo(e.target.files[0]);
            }
        });
        
        // 移除文件
        removeFileBtn.addEventListener('click', () => {
            fileInput.value = '';
            filePreview.classList.add('hidden');
            uploadIcon.classList.remove('hidden');
            uploadText.classList.remove('hidden');
        });
        
        // 拖拽功能
        uploadContainer.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadContainer.classList.add('border-primary', 'bg-blue-50');
        });
        
        uploadContainer.addEventListener('dragleave', () => {
            uploadContainer.classList.remove('border-primary', 'bg-blue-50');
        });
        
        uploadContainer.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadContainer.classList.remove('border-primary', 'bg-blue-50');
            
            if (e.dataTransfer.files.length > 0) {
                fileInput.files = e.dataTransfer.files;
                displayFileInfo(e.dataTransfer.files[0]);
            }
        });
        
        // 显示文件信息
        function displayFileInfo(file) {
            // 检查文件大小（10MB）
            const maxSize = 10 * 1024 * 1024; // 10MB
            if (file.size > maxSize) {
                alert('文件大小不能超过10MB');
                fileInput.value = '';
                return;
            }
            
            // 更新预览信息
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            
            // 设置文件图标
            setFileIcon(file.type);
            
            // 显示预览，隐藏上传提示
            filePreview.classList.remove('hidden');
            uploadIcon.classList.add('hidden');
            uploadText.classList.add('hidden');
        }
        
        // 设置文件图标
        function setFileIcon(fileType) {
            if (fileType.startsWith('image/')) {
                fileIcon.className = 'fa fa-file-image-o text-primary mr-3';
            } else if (fileType.includes('pdf')) {
                fileIcon.className = 'fa fa-file-pdf-o text-primary mr-3';
            } else if (fileType.includes('word')) {
                fileIcon.className = 'fa fa-file-word-o text-primary mr-3';
            } else if (fileType.includes('excel')) {
                fileIcon.className = 'fa fa-file-excel-o text-primary mr-3';
            } else if (fileType.includes('text')) {
                fileIcon.className = 'fa fa-file-text-o text-primary mr-3';
            } else {
                fileIcon.className = 'fa fa-file-o text-primary mr-3';
            }
        }
        
        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // 表单提交处理
        userForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 获取表单数据
            const formData = new FormData(this);
            const file = formData.get('file-upload');
            
            const formValues = {
                name: formData.get('name'),
                email: formData.get('email'),
                message: formData.get('message') || '',
                hobbies: Array.from(formData.getAll('hobbies')),
                file: file.name ? {
                    name: file.name,
                    size: file.size,
                    type: file.type
                } : null
            };
            
            // 保存数据到localStorage
            localStorage.setItem('formSubmission', JSON.stringify(formValues));
            
            // 显示结果页面
            showResultPage();
        });
        
        // 重置按钮额外处理（清除文件预览）
        userForm.addEventListener('reset', function() {
            filePreview.classList.add('hidden');
            uploadIcon.classList.remove('hidden');
            uploadText.classList.remove('hidden');
        });
        
        // 返回按钮事件
        backBtn.addEventListener('click', function() {
            // 显示表单页面
            formSection.classList.remove('hidden', 'opacity-0', 'translate-y-4');
            resultSection.classList.add('hidden', 'opacity-0', 'translate-y-4');
        });
        
        // 显示结果页面
        function showResultPage() {
            // 从localStorage获取数据
            const savedData = JSON.parse(localStorage.getItem('formSubmission'));
            
            if (savedData) {
                // 填充结果数据
                document.getElementById('result-name').textContent = savedData.name;
                document.getElementById('result-email').textContent = savedData.email;
                document.getElementById('result-message').textContent = savedData.message || '无留言';
                document.getElementById('result-hobbies').textContent = 
                    savedData.hobbies.length > 0 ? savedData.hobbies.join('、') : '未选择';
                
                // 显示文件信息
                const fileResult = document.getElementById('result-file');
                if (savedData.file) {
                    fileResult.innerHTML = `
                        <div class="flex items-center">
                            <i class="${getResultFileIconClass(savedData.file.type)} text-primary mr-2"></i>
                            <div>
                                <p>${savedData.file.name}</p>
                                <p class="text-sm text-neutral">${formatFileSize(savedData.file.size)}</p>
                            </div>
                        </div>
                    `;
                } else {
                    fileResult.innerHTML = '<p>未上传文件</p>';
                }
            }
            
            // 切换显示
            formSection.classList.add('hidden', 'opacity-0', 'translate-y-4');
            resultSection.classList.remove('hidden');
            
            // 添加动画效果
            setTimeout(() => {
                resultSection.classList.remove('opacity-0', 'translate-y-4');
            }, 50);
        }
        
        // 获取结果页文件图标类名
        function getResultFileIconClass(fileType) {
            if (fileType.startsWith('image/')) {
                return 'fa fa-file-image-o';
            } else if (fileType.includes('pdf')) {
                return 'fa fa-file-pdf-o';
            } else if (fileType.includes('word')) {
                return 'fa fa-file-word-o';
            } else if (fileType.includes('excel')) {
                return 'fa fa-file-excel-o';
            } else if (fileType.includes('text')) {
                return 'fa fa-file-text-o';
            } else {
                return 'fa fa-file-o';
            }
        }
        
        // 页面加载时检查是否有保存的数据
        document.addEventListener('DOMContentLoaded', function() {
            // 添加初始动画效果
            formSection.classList.add('opacity-0', 'translate-y-4');
            setTimeout(() => {
                formSection.classList.remove('opacity-0', 'translate-y-4');
            }, 100);
        });
    </script>
</body>
</html>
